# vim使用技巧

## 1. 搜索
要自当前光标位置向下搜索，请使用以下命令：

__/pattern Enter__

其中，pattern表示要搜索的特定字符序列。

要自当前光标位置向上搜索，请使用以下命令：

__?pattern Enter__

__n：继续查找，N：相反方向继续查找__

## 2. 搜索单词

  如果你用"/the"来查找Vim也会匹配到"there"。要查找作为独立单词的"the"使用如下命令："/the\>"。"\>"是一个特殊的记法，它只匹配一个word的结束处。近似地，"\<"匹配到一个word的开始处。这样查找作为一个word的"the"就可以用:"/\"。

```
以the结尾单词:/the\>  /the$

以the开头单词:/\<the  /^the

包含the单词: /\<the\>   /^the$
```

如果你想要搜索一个文件中的一个单词，但是又不想输入它，__你只需要将你的光标移到这个单词下然后按 * （或者 shift + 8）__

## 3. 高亮显示搜索结果
  
  开启这一功能用"__:set hlsearch__"，关闭这一功能：":set nohlsearch"。如果只是想去掉当前的高亮显示，可以使用下面的命令：":nohlsearch"(可以简写为noh)。

## 4. 执行shell命令

```
:!命令
```

## 5. 跳转到第一行或最后一行

```
第一行(:1或者gg)  :0
最后一行(G)      :$
```

## 6. 跳转到行首或行尾

```
行首(0)
行尾($)
```

## 7. 向下移动几行

```
数字 回车
```

## 8. 跳转到指定行

```
行号G
```

## 9. 移动光标至行尾

```
$
```

## 10. 删除当前字符至行尾

```
d$
```

## 11. 向下删除几行(从当前行算起)

```
数字dd

dd 删除当前行
```

## 12. 删除所在行到第几行的数据(包括起始行数据)

```
d数字G

d1G 删除当前行到第1行数据

dG 删除当前行到最后1行数据
```

## 13. 向下复制几行(从当前行算起)

```
数字yy

yy 复制当前行

```

## 14. 复制所在行到第几行的数据(包括起始行数据)

```
y数字G

y1G 复制当前行到第1行数据

```

## 15. 粘贴复制的行

```
放在当前行上面:shift+p或P

放在当前行下面:shift+P
```

##  16. 撤销

```
撤销:u 

取消撤销:<ctrl>+r 
```

## 17. 替换

```
替换该行第一个匹配串             :s/old/new 

替换全行的匹配串                   :s/old/new/g

替换整个文件的匹配串             :%s/old/new/g

替换n1至n2行的匹配串           :n1,n2s/old/new/g

替换整个文件的匹配串             :1,$s/old/new/g
```


## 18. 插入

```
在当前行上方插入新的行             O 

在当前行下方插入新的行             o 
```

## 19. 行号

```
设置行号             :set nu

取消行号             :set nonu
```

## 20. 不区分大小写

```
 忽略大小写             :set ic
 
不忽略大小写           :set noic

/搜索关键字,然后:set ic或者 :set noic
```

## 21. 小技巧:

```
跳转
0 移动到行首
$ 当前行的末尾
gg 文件第一行
G 文件最后一行
行号+G 指定行


删除

x 删除当前字符
dw 删除至当前单词末尾
d$ 删除至当前行尾
dd 删除整行
2dd 删除两行

删除换行符
 J 将下一行合并到当前行

修改

i 插入文本
A 当前行末尾添加
r 替换当前字符
o 打开新的一行并进入插入模式

撤销

u 撤销
<ctrl>+r 取消撤销

复制粘贴剪切

v 进入可视模式
y 复制
p 粘贴
yy 复制当前行
dd 剪切当前行(p粘贴)

```

## 22. 状态

```
<ctrl>+g 显示当前行(百分比)以及文件信息(文件名以及总行数)
```

## 23. 文本选择

```
v    从光标当前位置开始，光标所经过的地方会被选中(选择某行的某些字符) 

V    从光标当前行开始，光标经过的行都会被选中(选择某些行) 

Ctrl + v   从光标当前位置开始，选中光标起点和终点所构成的矩形区域(选择某些行某些字符) 


选中后就可以用编辑命令对其进行编辑，如 
d   删除 
y   复制 （默认是复制到"寄存器） 

vim编辑一个文件，进入文件后，按下Ctrl+v 键，会在左下角出现“可视块”字样，这个时候你就可以用上下键移动光标选择你要进行批量操作的行
按下Shift+i 键，进入块编辑模式 只需要在第一行首端添加井号（#）即可

按下Esc键，即可完成块编辑

按下Esc键后，你之前选择的块都会被注释掉

"gv" 命令再次选择上次选过的文本，让你对同一段文本再作别的修改。
```

## 24. 编辑另一个文件

```
  用命令":edit foo.txt"，也可简写为":e foo.txt"。(不能够回到上一个编辑文件)
```

## 25. 文件列表
  可以在启动Vim时就指定要编辑多个文件，用命令"vim one.c two.c three.c"。Vim将在启动后只显示第一个文件，完成该文件的编辑后，可以用令：":next"或":n"要保存工作成果并继续下一个文件的编辑，命令：":wnext"或":wn"可以合并这一过程。

## 26. 显示当前正在编辑的文件

```
用命令":args"。
```

## 27. 移动到另一个文件

```
  用命令":previous" ":prev"回到上一个文件,合并保存步骤则是":wprevious"    ":wprev"。
 
  要移到最后一个文件":last",到第一个":first".不过没有":wlast"或者":wfirst"这样的命令。
 
  可以在":next"和":previous"命令前面使用一个命令计数。
```

## 28. 编辑另一个文件列表

```
  不用重新启动Vim，就可以重新定义一个文件列表。命令":args five.c six.c seven.h"定义了要编辑的三个文件。(新建文件)
```

## 29. 自动存盘
  
```
  命令":set autowrite","set aw"。自动把内容写回文件: 如果文件被修改过，在每个:next、:rewind、:last、:first、:previous、:stop、:suspend、:tag、:!、:make、CTRL-] 和 CTRL-^命令时进行。
  命令":set autowriteall","set awa"。和 'autowrite' 类似，但也适用于":edit"、":enew"、":quit"、":qall"、":exit"、":xit"、":recover" 和关闭 Vim 窗口。置位本选项也意味着 Vim 的行为就像打开 'autowrite' 一样。
```

## 30. 切换到另一文件

```
  要在两个文件间快速切换，使用CTRL+^。  CTRL-^
```

## 31. 文件标记
  
  以大写字母命名的标记。它们是全局标记，它们可以用在任何文件中。比如，正在编辑"fab1.Java",用命令"50%mF"在文件的中间设置一个名为F的标记。然后在"fab2.java"文件中，用命令"GnB"在最后一行设置名为B的标记。在可以用"F"命令跳转到文件"fab1.java"的半中间。或者编辑另一个文件，"'B"命令会再把你带回文件"fab2.java"的最后一行。
  
  要知道某个标记所代表的位置是什么，可以将该标记的名字作为"marks"命令的参数":marks M"或者连续跟上几个参数":marks MJK"
  
  可以用CTRL-O和CTRL-I可以跳转到较早的位置和靠后的某位置。

## 32 .查看文件
  
仅是查看文件，不向文件写入内容，可以用只读形式编辑文件。用命令：
  
vim -R file   【可以使用:wq!强制保存】

如果是想强制性地避免对文件进行修改，可以用命令：

vim -M file   【完全不能够编辑】

## 33. 更改文件名
 
```
  将现有文件存成新的文件，用命令":sav(eas) move.c"。  【当前编辑器内容会创建一个新文件，并且自动保存 不会影响原文件内容】
  
  如果想改变当前正在编辑的文件名，但不想保存该文件，就可以用命令：":f(ile) move.c"。 【当前编辑器内容会创建一个新文件，不会自动保存，需要w或者wq  不会影响原文件内容】
```

## 34. 正则表达式配合字符串替换  把 "Last, First" 改成 "First Last"

你有如下样式的一个名字列表:

        Doe, John 
        Smith, Peter 

你想把它改成:

        John Doe 
        Peter Smith 

这可以用一个命令完成:

        :%s/\([^,]*\), \(.*\)/\2 \1/

我们把这个命令分解成几个部分。首先，很明显它是一个替换命令。"%" 是行范围，表示
作用于全文。这样替换命令会作用于全文的每一行。
    替换命令的参数格式是 "from/to"，正斜杠区分 "from" 模式和 "to" 字符串。所
以，"from" 部分是:
                                                        \([^,]*\), \(.*\) 

        第一对 \( 和 \) 之间的部分匹配 "Last"           \(     \)
            匹配除逗号外的任何东西                        [^,]
            任意多次                                          *
        匹配逗号                                                 ,
        第二对 \( 和 \) 之间的部分匹配 "First"                     \(  \)
            匹配任意字符                                             .
            任意多次                                                  *

在 "to" 部分，我们有 "\2" 和 "\1"。这些称为 "反向引用"。它们指向前面模式中的
\( 和 \) 间的部分。"\2" 指向模式中的第二对 \( 和 \) 间的部分，也就是 "First"
名 (译者注: 英文中 Last Name 表示姓，即家族名，后面的 First Name 表示名字)。
"\1" 指向第一对 \( \)，即 "Last" 名。
    你可以在替换部分使用多达 9 个反向引用。"\0" 表示整个匹配部分。还有一些特殊
的项可以用在替换命令中。


## 35. 挂起和继续

像多数 Unix 程序一样，Vim 可以按 CTRL-Z 挂起。这个动作把 Vim 停下来，并让你回
到那个你启动 Vim 的命令外壳里。接着，你可以执行任何别的命令直到你觉得无聊为
止。然后再用 "fg" 命令回到 Vim。 

```
CTRL-Z 或者 :suspend
 
{任何外壳命令序列}

fg
```
       
你正好回到那个当初你离开 Vim 的地方，什么也没改变。
  
   当你按 CTRL-Z 行不通时，你还可以用命令 ":suspend"。别忘了把 Vim 引导回前
台，否则你会失去你所有的修改！

只有 Unix 支持这个功能。在其它系统上 Vim 将为你启动一个外壳。这也让你得以执行
外壳命令。可那是一个新外壳，而非你在其中启动 Vim 的那个。

   当你运行图像用户界面时，你无法返回那个 Vim 从其中启动的外壳。CTRL-Z 的作用
只是把 Vim 窗口最小化。

## 36. 执行外壳命令

从 Vim 内部执行单个外壳命令，用 "__:!{command}__"。例如，要显示目录表: 

        :!ls
        :!dir

第一行用在 Unix 上，第二行用于微软视窗。
   Vim 将执行该程序。当它结束时，你会得到提示，让你击打 <Enter>。这提示允许你
在回去编辑你的文本之前看一看该命令的输出。
   字符 "!" 也用在其它有个程序被调用运行的场合。让我们看一看共有哪些:

```
        :!{program}             执行 {program}
        :r !{program}           执行 {program} 并读取其输出（将输出行追加到文件）
        :w !{program}           执行 {program} 传送文本至其输入
        :[range]!{program}      经由 {program} 过滤文本
```

注意 "!{program}" 前面那个作用区产生的区别可大了。不附带作用区，这个程序就跟
通常一样被执行，而加了这个作用区，作用区内的文本行就经由该程序过滤而出。

用这种方法执行一系列命令也是可以的。但外壳在此却更胜一筹。你可以用这种方法启动
一个新外壳: 

__:shell  创建一个新的bash进程，可以用exit退出__

这有点类似于用 CTRL-Z 来挂起 Vim。不同之处在于这种方法启动的是一个新外壳。

使用图像用户界面时，这个外壳利用 Vim 的窗口作为其输入和输出端口。既然 Vim 并非
终端仿真器，所以使用中未必尽善近美。要是你遇到麻烦，试试切换 'guipty' 选项。如
果这方法仍不奏效，那就只好启动一个新的终端来运行外壳。例如:

        :!xterm&



## 如何在vim保存时获得sudo权限

```
:w !sudo tee %   输入大写O
```

命令:w !{cmd}，让 vim 执行一个外部命令{cmd}，然后把当前缓冲区的内容从 stdin 传入。
tee 是一个把 stdin 保存到文件的小工具。
而 %，是vim当中一个只读寄存器的名字，总保存着当前编辑文件的文件路径。




